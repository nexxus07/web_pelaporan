{"version":3,"file":"static/js/883.23a58b49.chunk.js","mappings":"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","sources":["pages/user/UserProfile.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { getAuth, onAuthStateChanged } from \"firebase/auth\";\r\nimport \"./userprofile.scss\";\r\n\r\nfunction UserProfile() {\r\n  const [userData, setUserData] = useState(null);\r\n  const [laporan, setLaporan] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [isOffline, setIsOffline] = useState(!navigator.onLine);\r\n\r\n  useEffect(() => {\r\n    const auth = getAuth();\r\n    const unsubscribe = onAuthStateChanged(auth, async (user) => {\r\n      if (user) {\r\n        // Ambil profil user\r\n        const profile = {\r\n          nama: user.displayName,\r\n          email: user.email,\r\n          uid: user.uid,\r\n          foto: user.photoURL,\r\n        };\r\n        localStorage.setItem(\"cachedUserProfile\", JSON.stringify(profile));\r\n        setUserData(profile);\r\n\r\n        // Ambil cache histori laporan (kalau ada)\r\n        const cached = localStorage.getItem(\"cachedLaporan\");\r\n        if (cached) {\r\n          setLaporan(JSON.parse(cached));\r\n          setLoading(false);\r\n        }\r\n\r\n        // Fetch terbaru dari server (jika online)\r\n        if (navigator.onLine) {\r\n          try {\r\n            const res = await fetch(\r\n              `${\r\n                process.env.REACT_APP_API_URL || \"http://localhost:4000\"\r\n              }/api/pelaporan/user/${user.uid}`\r\n            );\r\n            if (!res.ok) throw new Error(\"Gagal fetch data dari server\");\r\n            const data = await res.json();\r\n            setLaporan(data);\r\n            localStorage.setItem(\"cachedLaporan\", JSON.stringify(data));\r\n          } catch (err) {\r\n            console.error(\"Gagal fetch laporan:\", err.message);\r\n          }\r\n        }\r\n\r\n        setLoading(false);\r\n      } else {\r\n        // Tidak ada user login → coba dari cache\r\n        const cachedProfile = localStorage.getItem(\"cachedUserProfile\");\r\n        if (cachedProfile) setUserData(JSON.parse(cachedProfile));\r\n\r\n        const cachedLaporan = localStorage.getItem(\"cachedLaporan\");\r\n        if (cachedLaporan) setLaporan(JSON.parse(cachedLaporan));\r\n\r\n        setLoading(false);\r\n      }\r\n    });\r\n\r\n    // Update status offline/online secara realtime\r\n    const handleOnline = () => setIsOffline(false);\r\n    const handleOffline = () => setIsOffline(true);\r\n    window.addEventListener(\"online\", handleOnline);\r\n    window.addEventListener(\"offline\", handleOffline);\r\n\r\n    return () => {\r\n      unsubscribe();\r\n      window.removeEventListener(\"online\", handleOnline);\r\n      window.removeEventListener(\"offline\", handleOffline);\r\n    };\r\n  }, []);\r\n\r\n  if (!userData && loading)\r\n    return <p style={{ padding: \"20px\" }}>Memuat profil...</p>;\r\n\r\n  return (\r\n    <div className=\"user-profile-container\">\r\n      {isOffline && (\r\n        <div className=\"user-profile-offline\">\r\n          ⚠️ Kamu sedang offline. Data yang ditampilkan berasal dari cache.\r\n        </div>\r\n      )}\r\n\r\n      {/* === USER PROFILE === */}\r\n      <div className=\"user-profile-header\">\r\n        <h2>Profil Pengguna</h2>\r\n      </div>\r\n      <div className=\"user-profile-info\">\r\n        <p>\r\n          <strong>Email:</strong> {userData?.email}\r\n        </p>\r\n        <p>\r\n          <strong>User ID:</strong> {userData?.uid}\r\n        </p>\r\n      </div>\r\n\r\n      <hr className=\"user-profile-divider\" />\r\n\r\n      {/* === HISTORI LAPORAN === */}\r\n      <div className=\"user-profile-history\">\r\n        <h2>Histori Laporan Anda</h2>\r\n        {loading ? (\r\n          <p>Memuat data laporan...</p>\r\n        ) : laporan.length === 0 ? (\r\n          <p>Belum ada laporan yang dikirim.</p>\r\n        ) : (\r\n          <ul>\r\n            {laporan.map((lapor) => (\r\n              <li key={lapor._id}>\r\n                <strong>{lapor.judul}</strong>\r\n                <br />\r\n                <span>\r\n                  {lapor.kategori} - {lapor.status}\r\n                </span>\r\n                <br />\r\n                <small>\r\n                  Tanggal Kejadian:{\" \"}\r\n                  {new Date(lapor.tanggal_kejadian).toLocaleDateString()}\r\n                </small>\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default UserProfile;\r\n"],"names":["userData","setUserData","useState","laporan","setLaporan","loading","setLoading","isOffline","setIsOffline","navigator","onLine","useEffect","auth","getAuth","unsubscribe","onAuthStateChanged","async","user","profile","nama","displayName","email","uid","foto","photoURL","localStorage","setItem","JSON","stringify","cached","getItem","parse","res","fetch","concat","process","ok","Error","data","json","err","console","error","message","cachedProfile","cachedLaporan","handleOnline","handleOffline","window","addEventListener","removeEventListener","_jsx","style","padding","children","_jsxs","className","length","map","lapor","judul","kategori","status","Date","tanggal_kejadian","toLocaleDateString","_id"],"sourceRoot":""}