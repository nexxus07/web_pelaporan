"use strict";(self.webpackChunksipelmasd_client=self.webpackChunksipelmasd_client||[]).push([[1],[,(e,t,a)=>{a.r(t),a.d(t,{default:()=>r});var n=a(43),s=a(579);const i="http://localhost:4000";const r=function(){const[e,t]=(0,n.useState)("pelaporans"),[a,r]=(0,n.useState)([]),[c,l]=(0,n.useState)([]),[d,o]=(0,n.useState)(!1);(0,n.useEffect)((()=>{const e=localStorage.getItem("token");e?fetch("".concat(i,"/api/admin/dashboard"),{headers:{Authorization:"Bearer ".concat(e)}}).then((e=>{if(!e.ok)throw new Error("Unauthorized");return e.json()})).catch((()=>{localStorage.removeItem("token"),window.location.href="/login-admin"})):window.location.href="/login-admin"}),[]);const[h,u]=(0,n.useState)(""),[j,x]=(0,n.useState)(!1),[p,m]=(0,n.useState)(null),[f,g]=(0,n.useState)("Proses"),[k,b]=(0,n.useState)([]),[v,w]=(0,n.useState)({}),S=async()=>{o(!0);try{const e=await fetch("".concat(i,"/api/pelaporan")),t=await e.json();r(t)}catch(e){r([])}o(!1)},C=async()=>{o(!0);try{const e=await fetch("".concat(i,"/api/user")),t=await e.json();l(t)}catch(e){l([])}o(!1)};(0,n.useEffect)((()=>{fetch("/data/provinsi.json").then((e=>e.json())).then(b).catch((()=>b([]))),fetch("/data/kabupaten.json").then((e=>e.json())).then(w).catch((()=>w({})))}),[]),(0,n.useEffect)((()=>{"pelaporans"===e&&S(),"users"===e&&C()}),[e]);const y=()=>{x(!1),m(null)},T=e=>{const t=k.find((t=>t.id===e));return t?t.nama:e},L=(e,t)=>{const a=(v[e]||[]).find((e=>e.id===t));return a?a.nama:t},N=a.filter((e=>Object.values(e).join(" ").toLowerCase().includes(h.toLowerCase()))),A=c.filter((e=>Object.values(e).join(" ").toLowerCase().includes(h.toLowerCase())));return(0,s.jsxs)("div",{className:"admin-container",children:[(0,s.jsx)("div",{className:"logout-container",style:{justifyContent:"flex-end"},children:(0,s.jsx)("button",{style:{background:"#e53935",color:"#fff",border:"none",borderRadius:"6px",padding:"8px 18px",fontWeight:600,cursor:"pointer"},onClick:()=>{localStorage.removeItem("token"),window.location.href="/login-admin"},children:"Logout"})}),(0,s.jsx)("h2",{children:"Admin Panel"}),(0,s.jsxs)("div",{className:"nav-tabs",children:[(0,s.jsx)("button",{className:"pelaporans"===e?"active":"",onClick:()=>{t("pelaporans"),u("")},children:"Pelaporan"}),(0,s.jsx)("button",{className:"users"===e?"active":"",onClick:()=>{t("users"),u("")},children:"User"})]}),(0,s.jsx)("div",{className:"filter-container",children:(0,s.jsx)("input",{type:"text",placeholder:"pelaporans"===e?"Cari pelaporan (judul, jenis, status, provinsi, dll)...":"Cari user (email, uid, dll)...",value:h,onChange:e=>u(e.target.value),className:"admin-filter-input"})}),(0,s.jsxs)("div",{className:"tab-content",children:["pelaporans"===e&&!d&&(0,s.jsxs)("table",{children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Judul"}),(0,s.jsx)("th",{children:"Jenis"}),(0,s.jsx)("th",{children:"Laporan"}),(0,s.jsx)("th",{children:"Tanggal Kejadian"}),(0,s.jsx)("th",{children:"Provinsi"}),(0,s.jsx)("th",{children:"Kabupaten"}),(0,s.jsx)("th",{children:"Kecamatan"}),(0,s.jsx)("th",{children:"Tujuan"}),(0,s.jsx)("th",{children:"Kategori"}),(0,s.jsx)("th",{children:"Status"}),(0,s.jsx)("th",{children:"Tanggal Input"}),(0,s.jsx)("th",{children:"Aksi"})]})}),(0,s.jsxs)("tbody",{children:[N.map((e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:e.judul}),(0,s.jsx)("td",{children:e.jenis}),(0,s.jsx)("td",{children:e.laporan}),(0,s.jsx)("td",{children:new Date(e.tanggal_kejadian).toLocaleDateString()}),(0,s.jsx)("td",{children:T(e.provinsi)}),(0,s.jsx)("td",{children:L(e.provinsi,e.kabupaten)}),(0,s.jsx)("td",{children:e.kecamatan}),(0,s.jsx)("td",{children:e.tujuan}),(0,s.jsx)("td",{children:e.kategori}),(0,s.jsx)("td",{children:e.status}),(0,s.jsx)("td",{children:e.createdAt?new Date(e.createdAt).toLocaleString():""}),(0,s.jsx)("td",{children:(0,s.jsx)("button",{onClick:()=>{return t=e._id,a=e.status,m(t),g("proses"===a?"Proses":"sudah terlaksana"===a?"Sudah Terlaksana":"Proses"),void x(!0);var t,a},children:"Update Status"})})]},e._id))),0===N.length&&(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:12,children:"Tidak ada data"})})]})]}),"users"===e&&!d&&(0,s.jsxs)("table",{children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Email"}),(0,s.jsx)("th",{children:"UID"}),(0,s.jsx)("th",{children:"Created At"}),(0,s.jsx)("th",{children:"Aksi"})]})}),(0,s.jsxs)("tbody",{children:[A.map((e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:e.email}),(0,s.jsx)("td",{children:e.uid}),(0,s.jsx)("td",{children:new Date(e.createdAt).toLocaleString()}),(0,s.jsx)("td",{children:(0,s.jsx)("button",{style:{background:"#e53935",color:"#fff",border:"none",borderRadius:"4px",padding:"6px 12px",cursor:"pointer"},onClick:()=>(async e=>{window.confirm("Apakah Anda yakin ingin menghapus akun ini?")&&(await fetch("".concat(i,"/api/user/").concat(e),{method:"DELETE"}),C())})(e._id),children:"Hapus"})})]},e._id))),0===A.length&&(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:4,children:"Tidak ada data"})})]})]}),j&&(0,s.jsx)("div",{className:"modal-backdrop",children:(0,s.jsxs)("div",{className:"modal-content",children:[(0,s.jsx)("h3",{children:"Update Status Pelaporan"}),(0,s.jsxs)("select",{value:f,onChange:e=>g(e.target.value),children:[(0,s.jsx)("option",{value:"Proses",children:"Proses"}),(0,s.jsx)("option",{value:"Sudah Terlaksana",children:"Sudah Terlaksana"})]}),(0,s.jsxs)("div",{style:{marginTop:16},children:[(0,s.jsx)("button",{onClick:async()=>{p&&(await fetch("".concat(i,"/api/pelaporan/").concat(p),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:f.toLowerCase()})}),y(),S())},style:{marginRight:8},children:"Simpan"}),(0,s.jsx)("button",{onClick:y,children:"Batal"})]})]})})]})]})}}]]);
//# sourceMappingURL=1.9697714f.chunk.js.map